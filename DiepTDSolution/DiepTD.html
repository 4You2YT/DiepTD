<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>
    <canvas id="myCanvas" width="1024" height="1024"></canvas>
    <script>
        var c = document.getElementById("myCanvas");
        var ctx = c.getContext("2d");
        var x = 0;
        var y = 0;
        var xS = [123];
        var yS = [351];
        var tS = [0];
        //TODO: hit points
        var hPS = [150];
        var mHPS = [150];
        var tMRS = [0];
        var dS = [1];
        var pMX = 0;
        var pMY = 0;
        var mP = {};
        var mID = 0;
        var lctr = 0;
        var ctr = 0;
        var ctr2 = 0;
        var ctr3 = 0;
        var ctr4 = 0;
        var ctr5 = 0;
        var ctr6 = 0;
        var xP = [0, 240, -320];
        var yP = [0, -564, 123];
        var tP = [0, 1, 2];
        var hPP = [100, 200, 1000];
        var xE = [157];
        var yE = [110];
        var tE = [0];
        var dE = [1];
        var hPE = [30];
        var mHPE = [30];
        var tMRE = [0]
        var xB = [];
        var yB = [];
        var dB = [];
        var lTB = [];
        var teams = [];
        var vB = [];
        var cEV = 0;
        var cEV2 = 0;
        var cEV3 = 0;
        var cED = 0;
        var cED2 = 0;
        var keys = [];
        var keys2 = [];
        var sT = 0;
        var sT2 = 0;
        var sTV = 0;
        while (ctr < 256) {
            keys.push(0);
            keys2.push(0);
            ctr++;
        }
        ctr = 0;
        function getMousePos(canvas, evt) {
            var rect = canvas.getBoundingClientRect();
            mP = { x: evt.clientX - rect.left, y: evt.clientY - rect.top };
            if (mID == 1) {
                x = x + (pMX - mP.x);
                y = y + (pMY - mP.y);
                //ctr4 = 0;
                //sT2 = 0;
                //while (ctr4 < xS.length) {
                //    if (Math.sqrt(Math.pow(xS[ctr4] - (mP.x + x - 512), 2) + Math.pow(yS[ctr4] - (mP.y + y - 512), 2)) < 10) {
                //        sT = 1;
                //        sT2 = 1;
                //        sTV = ctr4;
                //    } else if (Math.sqrt(Math.pow(xS[ctr4] - (mP.x + x - 512), 2) + Math.pow(yS[ctr4] - (mP.y + y - 512), 2)) > 10 && sT2 == 0) {
                //        sT = 0;
                //    }
                //    ctr4++;
                //}
            }
            //if (mID == 1 && pMX - mP.x < 10 && pMY - mP.y < 10) {
            //    ctx.fillRect(50, 50, 50, 50);
            //}
        }
        function mouseDown(e) {
            mID = 1;
            ctr4 = 0;
            sT2 = 0;
            while (ctr4 < xS.length) {
                if (Math.sqrt(Math.pow(xS[ctr4] - (mP.x + x - 512), 2) + Math.pow(yS[ctr4] - (mP.y + y - 512), 2)) < 20) {
                    sT = 1;
                    sT2 = 1;
                    sTV = ctr4;
                } else if (Math.sqrt(Math.pow(xS[ctr4] - (mP.x + x - 512), 2) + Math.pow(yS[ctr4] - (mP.y + y - 512), 2)) > 20 && sT2 == 0) {
                    sT = 0;
                }
                ctr4++;
            }
        }
        function mouseUp(e) {
            mID = 0;
        }
        function keyDown(e) {
            keys[e.keyCode] = true;
            if (keys2[e.keyCode] == 0) {
                keys2[e.keyCode] = 1;
            }
        }
        function keyUp(e) {
            keys[e.keyCode] = false;
            keys2[e.keyCode] = 0;
        }
        window.addEventListener("keydown", keyDown, false);
        window.addEventListener("keyup", keyUp, false);
        c.addEventListener('mousemove', function (evt) {
            pMX = mP.x;
            pMY = mP.y;
            getMousePos(c, evt);
        }, false);
        c.addEventListener("mousedown", mouseDown, false);
        c.addEventListener("mouseup", mouseUp, false);
        function renderBarrel(x, y, l, w, offset, dir) {
            ctx.beginPath();
            ctx.fillStyle = "#555555";
            ctx.moveTo((offset + w / 2) * Math.cos(dir - Math.PI / 2) + x, (offset + w / 2) * Math.sin(dir - Math.PI / 2) + y);
            ctx.lineTo((offset + w / 2) * Math.cos(dir - Math.PI / 2) - l * Math.sin(dir - Math.PI / 2) + x, (offset + w / 2) * Math.sin(dir - Math.PI / 2) + l * Math.cos(dir - Math.PI / 2) + y);
            ctx.lineTo((offset + w / -2) * Math.cos(dir - Math.PI / 2) - l * Math.sin(dir - Math.PI / 2) + x, (offset + w / -2) * Math.sin(dir - Math.PI / 2) + l * Math.cos(dir - Math.PI / 2) + y);
            ctx.lineTo((offset + w / -2) * Math.cos(dir - Math.PI / 2) + x, (offset + w / -2) * Math.sin(dir - Math.PI / 2) + y);
            ctx.fill();
            ctx.closePath();
            ctx.beginPath();
            ctx.fillStyle = "#999999";
            ctx.moveTo(((offset - 3) + w / 2) * Math.cos(dir - Math.PI / 2) + x, ((offset - 3) + w / 2) * Math.sin(dir - Math.PI / 2) + y);
            ctx.lineTo(((offset - 3) + w / 2) * Math.cos(dir - Math.PI / 2) - (l - 3) * Math.sin(dir - Math.PI / 2) + x, ((offset - 3) + w / 2) * Math.sin(dir - Math.PI / 2) + (l - 3) * Math.cos(dir - Math.PI / 2) + y);
            ctx.lineTo(((offset + 3) + w / -2) * Math.cos(dir - Math.PI / 2) - (l - 3) * Math.sin(dir - Math.PI / 2) + x, ((offset + 3) + w / -2) * Math.sin(dir - Math.PI / 2) + (l - 3) * Math.cos(dir - Math.PI / 2) + y);
            ctx.lineTo(((offset + 3) + w / -2) * Math.cos(dir - Math.PI / 2) + x, ((offset + 3) + w / -2) * Math.sin(dir - Math.PI / 2) + y);
            ctx.fill();
            ctx.closePath();
        }
        function renderShadowBarrel(x, y, l, w, offset, dir) {
            ctx.beginPath();
            ctx.fillStyle = "rgb(110, 110, 110)";
            ctx.moveTo((offset + (w / 2) * 1.15) * Math.cos(dir - Math.PI / 2) + 512 + (x - 512) * 1.1, (offset + (w / 2) * 1.15) * Math.sin(dir - Math.PI / 2) + 512 + (y - 512) * 1.1);
            ctx.lineTo((offset + (w / 2) * 1.15) * Math.cos(dir - Math.PI / 2) - (l * 1.15) * Math.sin(dir - Math.PI / 2) + 512 + (x - 512) * 1.1, (offset + (w / 2) * 1.1) * Math.sin(dir - Math.PI / 2) + (l * 1.15) * Math.cos(dir - Math.PI / 2) + 512 + (y - 512) * 1.1);
            ctx.lineTo((offset + (w / -2) * 1.15) * Math.cos(dir - Math.PI / 2) - (l * 1.15) * Math.sin(dir - Math.PI / 2) + 512 + (x - 512) * 1.1, (offset + (w / -2) * 1.1) * Math.sin(dir - Math.PI / 2) + (l * 1.15) * Math.cos(dir - Math.PI / 2) + 512 + (y - 512) * 1.1);
            ctx.lineTo((offset + (w / -2) * 1.15) * Math.cos(dir - Math.PI / 2) + 512 + (x - 512) * 1.1, (offset + (w / -2) * 1.15) * Math.sin(dir - Math.PI / 2) + 512 + (y - 512) * 1.1);
            ctx.fill();
            ctx.closePath();
        }
        function renderTrapezoidBarrel(x, y, l, w, offset, dir, outerWidth) {
            ctx.beginPath();
            ctx.fillStyle = "#555555";
            ctx.moveTo((offset + w / 2) * Math.cos(dir - Math.PI / 2) + x, (offset + w / 2) * Math.sin(dir - Math.PI / 2) + y);
            ctx.lineTo((offset + outerWidth / 2) * Math.cos(dir - Math.PI / 2) - l * Math.sin(dir - Math.PI / 2) + x, (offset + outerWidth / 2) * Math.sin(dir - Math.PI / 2) + l * Math.cos(dir - Math.PI / 2) + y);
            ctx.lineTo((offset + outerWidth / -2) * Math.cos(dir - Math.PI / 2) - l * Math.sin(dir - Math.PI / 2) + x, (offset + outerWidth / -2) * Math.sin(dir - Math.PI / 2) + l * Math.cos(dir - Math.PI / 2) + y);
            ctx.lineTo((offset + w / -2) * Math.cos(dir - Math.PI / 2) + x, (offset + w / -2) * Math.sin(dir - Math.PI / 2) + y);
            ctx.fill();
            ctx.closePath();
            ctx.beginPath();
            ctx.fillStyle = "#999999";
            ctx.moveTo(((offset - 3) + w / 2) * Math.cos(dir - Math.PI / 2) + x, ((offset - 3) + w / 2) * Math.sin(dir - Math.PI / 2) + y);
            ctx.lineTo(((offset - 3) + outerWidth / 2) * Math.cos(dir - Math.PI / 2) - (l - 3) * Math.sin(dir - Math.PI / 2) + x, ((offset - 3) + outerWidth / 2) * Math.sin(dir - Math.PI / 2) + (l - 3) * Math.cos(dir - Math.PI / 2) + y);
            ctx.lineTo(((offset + 3) + outerWidth / -2) * Math.cos(dir - Math.PI / 2) - (l - 3) * Math.sin(dir - Math.PI / 2) + x, ((offset + 3) + outerWidth / -2) * Math.sin(dir - Math.PI / 2) + (l - 3) * Math.cos(dir - Math.PI / 2) + y);
            ctx.lineTo(((offset + 3) + w / -2) * Math.cos(dir - Math.PI / 2) + x, ((offset + 3) + w / -2) * Math.sin(dir - Math.PI / 2) + y);
            ctx.fill();
            ctx.closePath();
        }
        function renderTrapezoidShadowBarrel(x, y, l, w, offset, dir, outerWidth) {
            ctx.beginPath();
            ctx.fillStyle = "rgb(110, 110, 110)";
            ctx.moveTo((offset + (w / 2) * 1.15) * Math.cos(dir - Math.PI / 2) + 512 + (x - 512) * 1.1, (offset + (w / 2) * 1.15) * Math.sin(dir - Math.PI / 2) + 512 + (y - 512) * 1.1);
            ctx.lineTo((offset + (outerWidth / 2) * 1.15) * Math.cos(dir - Math.PI / 2) - (l * 1.15) * Math.sin(dir - Math.PI / 2) + 512 + (x - 512) * 1.1, (offset + (outerWidth / 2) * 1.1) * Math.sin(dir - Math.PI / 2) + (l * 1.15) * Math.cos(dir - Math.PI / 2) + 512 + (y - 512) * 1.1);
            ctx.lineTo((offset + (outerWidth / -2) * 1.15) * Math.cos(dir - Math.PI / 2) - (l * 1.15) * Math.sin(dir - Math.PI / 2) + 512 + (x - 512) * 1.1, (offset + (outerWidth / -2) * 1.1) * Math.sin(dir - Math.PI / 2) + (l * 1.15) * Math.cos(dir - Math.PI / 2) + 512 + (y - 512) * 1.1);
            ctx.lineTo((offset + (w / -2) * 1.15) * Math.cos(dir - Math.PI / 2) + 512 + (x - 512) * 1.1, (offset + (w / -2) * 1.15) * Math.sin(dir - Math.PI / 2) + 512 + (y - 512) * 1.1);
            ctx.fill();
            ctx.closePath();
        }
        function summonBullet(x, y, dir, lifetime, team, vel) {
            xB.push(x);
            yB.push(y);
            dB.push(dir);
            lTB.push(lifetime);
            teams.push(team);
            vB.push(vel);
        }
        function summonTower(x, y, type) {
            xS.push(x);
            yS.push(y);
            tS.push(type);
            tMRS.push(0);
            dS.push(0);
            if (type == 0) {
                hPS.push(150);
                mHPS.push(150);
            }
            if (type == 1) {
                hPS.push(225);
                mHPS.push(225);
            }
            if (type == 2) {
                hPS.push(275);
                mHPS.push(275);
            }
            if (type == 3) {
                hPS.push(250);
                mHPS.push(250);
            }
        }
        function summonEnemy(x, y, type) {
            xE.push(x);
            yE.push(y);
            tE.push(type);
            tMRE.push(0);
            dE.push(0);
            if (type == 0) {
                hPE.push(30);
                mHPE.push(30);
            } else if (type == 1) {
                hPE.push(40);
                mHPE.push(40);
            } else if (type == 2) {
                hPE.push(50);
                mHPE.push(50);
            } else if (type == 3) {
                hPE.push(45);
                mHPE.push(45);
            }
        }
        function polygon(x, y, sides, size, dir, color) {
            ctr6 = 0;
            ctx.beginPath();
            ctx.fillStyle = color;
            ctx.moveTo(x + Math.cos(dir) * size, y + Math.sin(dir) * size);
            while (ctr6 < sides) {
                ctx.lineTo(x + Math.cos(dir + ctr6 * (2 * Math.PI) / sides) * size, y + Math.sin(dir + ctr6 * (2 * Math.PI) / sides) * size);
                ctr6++;
            }
            ctx.fill();
            ctx.closePath();
        }
        function loop() {
            if (keys2[32] == 1) {
                summonTower(x + mP.x - 512, y + mP.y - 512, 0);
                keys2[32] = 2;
            }
            if (keys2[65] == 1) {
                summonEnemy(x + mP.x - 512, y + mP.y - 512, 0);
                keys2[65] = 2;
            }
            if (keys2[68] == 1) {
                summonEnemy(x + mP.x - 512, y + mP.y - 512, 1);
                keys2[68] = 2;
            }
            if (keys2[67] == 1) {
                summonEnemy(x + mP.x - 512, y + mP.y - 512, 2);
                keys2[67] = 2;
            }
            if (keys2[66] == 1) {
                summonTower(x + mP.x - 512, y + mP.y - 512, 1);
                keys2[66] = 2;
            }
            if (keys2[69] == 1) {
                summonTower(x + mP.x - 512, y + mP.y - 512, 2);
                keys2[69] = 2;
            }
            if (keys2[87] == 1) {
                summonEnemy(x + mP.x - 512, y + mP.y - 512, 3);
                keys2[87] = 2;
            }
            if (keys2[83] == 1) {
                summonTower(x + mP.x - 512, y + mP.y - 512, 3);
                keys2[83] = 2;
            }
            ctx.fillStyle = "#CBCBCB";
            ctx.fillRect(0, 0, 1024, 1024);
            ctr = 0;
            ctx.beginPath();
            ctx.lineWidth = 5;
            ctx.strokeStyle = "rgba(40, 40, 40, 0.23)";
            while (ctr < 9) {
                ctx.moveTo((128 * ctr - 64 - x + 64 * Math.floor(x / 64)) * 1.1, 0);
                ctx.lineTo((128 * ctr - 64 - x + 64 * Math.floor(x / 64)) * 1.1, 1027);
                ctx.lineTo((128 * ctr - x + 64 * Math.floor(x / 64)) * 1.1, 1027);
                ctx.lineTo((128 * ctr - x + 64 * Math.floor(x / 64)) * 1.1, 0);
                ctr++
            }
            ctx.stroke();
            ctx.closePath();
            ctr = 0;
            ctx.beginPath();
            while (ctr < 9) {
                ctx.moveTo(0, (128 * ctr - 64 - y + 64 * Math.floor(y / 64)) * 1.1);
                ctx.lineTo(1027, (128 * ctr - 64 - y + 64 * Math.floor(y / 64)) * 1.1);
                ctx.lineTo(1027, (128 * ctr - y + 64 * Math.floor(y / 64)) * 1.1);
                ctx.lineTo(0, (128 * ctr - y + 64 * Math.floor(y / 64)) * 1.1);
                ctr++
            }
            ctx.stroke();
            ctx.closePath();
            ctr = 0;
            while (ctr < xB.length) {
                xB[ctr] = xB[ctr] + Math.cos(dB[ctr]) * vB[ctr];
                yB[ctr] = yB[ctr] + Math.sin(dB[ctr]) * vB[ctr];
                lTB[ctr]--;
                if (teams[ctr] == 0) {
                    ctx.beginPath();
                    ctx.fillStyle = "rgb(110, 110, 110)";
                    ctx.arc((xB[ctr] - x) * 1.1 + 512, (yB[ctr] - y) * 1.1 + 512, 15, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.fillStyle = "#555555";
                    ctx.arc(xB[ctr] - x + 512, yB[ctr] - y + 512, 12, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.fillStyle = "#00B2E1";
                    ctx.arc(xB[ctr] - x + 512, yB[ctr] - y + 512, 9, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.closePath()
                    ctr2 = 0
                    while (ctr2 < xE.length) {
                        if (Math.sqrt(Math.pow(xB[ctr] - xE[ctr2], 2) + Math.pow(yB[ctr] - yE[ctr2], 2)) < 15) {
                            hPE[ctr2] = hPE[ctr2] - 10
                            xB.splice(ctr, 1);
                            yB.splice(ctr, 1);
                            dB.splice(ctr, 1);
                            teams.splice(ctr, 1);
                            vB.splice(ctr, 1);
                            lTB.splice(ctr, 1);
                        }
                        ctr2++;
                    }
                } else {
                    ctx.beginPath();
                    ctx.fillStyle = "rgb(110, 110, 110)";
                    ctx.arc((xB[ctr] - x) * 1.1 + 512, (yB[ctr] - y) * 1.1 + 512, 10, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.fillStyle = "#555555";
                    ctx.arc(xB[ctr] - x + 512, yB[ctr] - y + 512, 8, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.fillStyle = "#F14E54";
                    ctx.arc(xB[ctr] - x + 512, yB[ctr] - y + 512, 5, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.closePath()
                    ctr2 = 0
                    while (ctr2 < xS.length) {
                        if (Math.sqrt(Math.pow(xB[ctr] - xS[ctr2], 2) + Math.pow(yB[ctr] - yS[ctr2], 2)) < 20) {
                            hPS[ctr2] = hPS[ctr2] - 10
                            xB.splice(ctr, 1);
                            yB.splice(ctr, 1);
                            dB.splice(ctr, 1);
                            teams.splice(ctr, 1);
                            vB.splice(ctr, 1);
                            lTB.splice(ctr, 1);
                        }
                        ctr2++;
                    }
                }
                if (lTB[ctr] < 0) {
                    xB.splice(ctr, 1);
                    yB.splice(ctr, 1);
                    dB.splice(ctr, 1);
                    vB.splice(ctr, 1);
                    teams.splice(ctr, 1);
                    lTB.splice(ctr, 1);
                }
                ctr++;
            }
            ctr = 0;
            while (ctr < xS.length) {
                if (tS[ctr] == 0) {
                    renderShadowBarrel(xS[ctr] - x + 512, yS[ctr] - y + 512, 43, 21, 0, dS[ctr]);
                    polygon((xS[ctr] - x) * 1.1 + 512, (yS[ctr] - y) * 1.1 + 512, 6, 30, 0, "rgb(110, 110, 110)");
                }
                if (tS[ctr] == 1) {
                    renderShadowBarrel(xS[ctr] - x + 512, yS[ctr] - y + 512, 43, 21, 0, dS[ctr]);
                    polygon((xS[ctr] - x) * 1.1 + 512, (yS[ctr] - y) * 1.1 + 512, 6, 35, 0, "rgb(110, 110, 110)");
                }
                if (tS[ctr] == 2) {
                    renderShadowBarrel(xS[ctr] - x + 512, yS[ctr] - y + 512, 43, 21, 14, dS[ctr]);
                    renderShadowBarrel(xS[ctr] - x + 512, yS[ctr] - y + 512, 43, 21, -14, dS[ctr]);
                    polygon((xS[ctr] - x) * 1.1 + 512, (yS[ctr] - y) * 1.1 + 512, 6, 35, 0, "rgb(110, 110, 110)");
                }
                if (tS[ctr] == 3) {
                    renderTrapezoidShadowBarrel(xS[ctr] - x + 512, yS[ctr] - y + 512, 48, 24, 0, dS[ctr], 42);
                    polygon((xS[ctr] - x) * 1.1 + 512, (yS[ctr] - y) * 1.1 + 512, 6, 35, 0, "rgb(110, 110, 110)");
                }
                ctr++;
            }
            ctr = 0;
            while (ctr < xP.length) {
                if (tP[ctr] == 0) {
                    //ctx.beginPath();
                    //ctx.fillStyle = "rgb(110, 110, 110)";
                    //ctx.moveTo(28 * Math.cos(lctr / 100) + (xP[ctr] - x) * 1.1 + 512, 28 * Math.sin(lctr / 100) + (yP[ctr] - y) * 1.1 + 512);
                    //ctx.lineTo(28 * Math.cos(lctr / 100 + Math.PI / 2) + (xP[ctr] - x) * 1.1 + 512, 28 * Math.sin(lctr / 100 + Math.PI / 2) + (yP[ctr] - y) * 1.1 + 512);
                    //ctx.lineTo(28 * Math.cos(lctr / 100 + Math.PI) + (xP[ctr] - x) * 1.1 + 512, 28 * Math.sin(lctr / 100 + Math.PI) + (yP[ctr] - y) * 1.1 + 512);
                    //ctx.lineTo(28 * Math.cos(lctr / 100 + 3 * Math.PI / 2) + (xP[ctr] - x) * 1.1 + 512, 28 * Math.sin(lctr / 100 + 3 * Math.PI / 2) + (yP[ctr] - y) * 1.1 + 512);
                    //ctx.fill();
                    //ctx.closePath();
                    polygon((xP[ctr] - x) * 1.1 + 512, (yP[ctr] - y) * 1.1 + 512, 4, 28, lctr / 100, "rgb(110, 110, 110)");
                    //ctx.beginPath();
                    //ctx.fillStyle = "#555555";
                    //ctx.moveTo(24 * Math.cos(lctr / 100) + xP[ctr] - x + 512, 24 * Math.sin(lctr / 100) + yP[ctr] - y + 512);
                    //ctx.lineTo(24 * Math.cos(lctr / 100 + Math.PI / 2) + xP[ctr] - x + 512, 24 * Math.sin(lctr / 100 + Math.PI / 2) + yP[ctr] - y + 512);
                    //ctx.lineTo(24 * Math.cos(lctr / 100 + Math.PI) + xP[ctr] - x + 512, 24 * Math.sin(lctr / 100 + Math.PI) + yP[ctr] - y + 512);
                    //ctx.lineTo(24 * Math.cos(lctr / 100 + 3 * Math.PI / 2) + xP[ctr] - x + 512, 24 * Math.sin(lctr / 100 + 3 * Math.PI / 2) + yP[ctr] - y + 512);
                    //ctx.fill();
                    //ctx.closePath();
                    polygon((xP[ctr] - x) + 512, (yP[ctr] - y) + 512, 4, 24, lctr / 100, "#555555");
                    //ctx.beginPath();
                    //ctx.fillStyle = "#FFE95E";
                    //ctx.moveTo(20 * Math.cos(lctr / 100) + xP[ctr] - x + 512, 20 * Math.sin(lctr / 100) + yP[ctr] - y + 512);
                    //ctx.lineTo(20 * Math.cos(lctr / 100 + Math.PI / 2) + xP[ctr] - x + 512, 20 * Math.sin(lctr / 100 + Math.PI / 2) + yP[ctr] - y + 512);
                    //ctx.lineTo(20 * Math.cos(lctr / 100 + Math.PI) + xP[ctr] - x + 512, 20 * Math.sin(lctr / 100 + Math.PI) + yP[ctr] - y + 512);
                    //ctx.lineTo(20 * Math.cos(lctr / 100 + 3 * Math.PI / 2) + xP[ctr] - x + 512, 20 * Math.sin(lctr / 100 + 3 * Math.PI / 2) + yP[ctr] - y + 512);
                    //ctx.fill();
                    //ctx.closePath();
                    polygon((xP[ctr] - x) + 512, (yP[ctr] - y) + 512, 4, 20, lctr / 100, "#FFE95E");
                }
                if (tP[ctr] == 1) {
                    ctx.beginPath();
                    ctx.fillStyle = "rgb(110, 110, 110)";
                    ctx.moveTo(26 * Math.cos(lctr / 100) + (xP[ctr] - x) * 1.1 + 512, 26 * Math.sin(lctr / 100) + (yP[ctr] - y) * 1.1 + 512);
                    ctx.lineTo(26 * Math.cos(lctr / 100 + Math.PI / 1.5) + (xP[ctr] - x) * 1.1 + 512, 26 * Math.sin(lctr / 100 + Math.PI / 1.5) + (yP[ctr] - y) * 1.1 + 512);
                    ctx.lineTo(26 * Math.cos(lctr / 100 + Math.PI / 0.75) + (xP[ctr] - x) * 1.1 + 512, 26 * Math.sin(lctr / 100 + Math.PI / 0.75) + (yP[ctr] - y) * 1.1 + 512);
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.fillStyle = "#555555";
                    ctx.moveTo(22 * Math.cos(lctr / 100) + xP[ctr] - x + 512, 22 * Math.sin(lctr / 100) + yP[ctr] - y + 512);
                    ctx.lineTo(22 * Math.cos(lctr / 100 + Math.PI / 1.5) + xP[ctr] - x + 512, 22 * Math.sin(lctr / 100 + Math.PI / 1.5) + yP[ctr] - y + 512);
                    ctx.lineTo(22 * Math.cos(lctr / 100 + Math.PI / 0.75) + xP[ctr] - x + 512, 22 * Math.sin(lctr / 100 + Math.PI / 0.75) + yP[ctr] - y + 512);
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.fillStyle = "#FC7677";
                    ctx.moveTo(17 * Math.cos(lctr / 100) + xP[ctr] - x + 512, 17 * Math.sin(lctr / 100) + yP[ctr] - y + 512);
                    ctx.lineTo(17 * Math.cos(lctr / 100 + Math.PI / 1.5) + xP[ctr] - x + 512, 17 * Math.sin(lctr / 100 + Math.PI / 1.5) + yP[ctr] - y + 512);
                    ctx.lineTo(17 * Math.cos(lctr / 100 + Math.PI / 0.75) + xP[ctr] - x + 512, 17 * Math.sin(lctr / 100 + Math.PI / 0.75) + yP[ctr] - y + 512);
                    ctx.fill();
                    ctx.closePath();
                }
                if (tP[ctr] == 2) {
                    ctx.beginPath();
                    ctx.fillStyle = "rgb(110, 110, 110)";
                    ctx.moveTo(35 * Math.cos(lctr / 100) + (xP[ctr] - x) * 1.1 + 512, 35 * Math.sin(lctr / 100) + (yP[ctr] - y) * 1.1 + 512);
                    ctx.lineTo(35 * Math.cos(lctr / 100 + Math.PI / 2.5) + (xP[ctr] - x) * 1.1 + 512, 35 * Math.sin(lctr / 100 + Math.PI / 2.5) + (yP[ctr] - y) * 1.1 + 512);
                    ctx.lineTo(35 * Math.cos(lctr / 100 + Math.PI / 1.25) + (xP[ctr] - x) * 1.1 + 512, 35 * Math.sin(lctr / 100 + Math.PI / 1.25) + (yP[ctr] - y) * 1.1 + 512);
                    ctx.lineTo(35 * Math.cos(lctr / 100 + 6 * Math.PI / 5) + (xP[ctr] - x) * 1.1 + 512, 35 * Math.sin(lctr / 100 + 6 * Math.PI / 5) + (yP[ctr] - y) * 1.1 + 512);
                    ctx.lineTo(35 * Math.cos(lctr / 100 + Math.PI / 0.625) + (xP[ctr] - x) * 1.1 + 512, 35 * Math.sin(lctr / 100 + Math.PI / 0.625) + (yP[ctr] - y) * 1.1 + 512);
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.fillStyle = "#555555";
                    ctx.moveTo(31 * Math.cos(lctr / 100) + xP[ctr] - x + 512, 31 * Math.sin(lctr / 100) + yP[ctr] - y + 512);
                    ctx.lineTo(31 * Math.cos(lctr / 100 + Math.PI / 2.5) + xP[ctr] - x + 512, 31 * Math.sin(lctr / 100 + Math.PI / 2.5) + yP[ctr] - y + 512);
                    ctx.lineTo(31 * Math.cos(lctr / 100 + Math.PI / 1.25) + xP[ctr] - x + 512, 31 * Math.sin(lctr / 100 + Math.PI / 1.25) + yP[ctr] - y + 512);
                    ctx.lineTo(31 * Math.cos(lctr / 100 + 6 * Math.PI / 5) + xP[ctr] - x + 512, 31 * Math.sin(lctr / 100 + 6 * Math.PI / 5) + yP[ctr] - y + 512);
                    ctx.lineTo(31 * Math.cos(lctr / 100 + Math.PI / 0.625) + xP[ctr] - x + 512, 31 * Math.sin(lctr / 100 + Math.PI / 0.625) + yP[ctr] - y + 512);
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.fillStyle = "#768DFC";
                    ctx.moveTo(27 * Math.cos(lctr / 100) + xP[ctr] - x + 512, 27 * Math.sin(lctr / 100) + yP[ctr] - y + 512);
                    ctx.lineTo(27 * Math.cos(lctr / 100 + Math.PI / 2.5) + xP[ctr] - x + 512, 27 * Math.sin(lctr / 100 + Math.PI / 2.5) + yP[ctr] - y + 512);
                    ctx.lineTo(27 * Math.cos(lctr / 100 + Math.PI / 1.25) + xP[ctr] - x + 512, 27 * Math.sin(lctr / 100 + Math.PI / 1.25) + yP[ctr] - y + 512);
                    ctx.lineTo(27 * Math.cos(lctr / 100 + 6 * Math.PI / 5) + xP[ctr] - x + 512, 27 * Math.sin(lctr / 100 + 6 * Math.PI / 5) + yP[ctr] - y + 512);
                    ctx.lineTo(27 * Math.cos(lctr / 100 + Math.PI / 0.625) + xP[ctr] - x + 512, 27 * Math.sin(lctr / 100 + Math.PI / 0.625) + yP[ctr] - y + 512);
                    ctx.fill();
                    ctx.closePath();
                }
                ctr++;
            }
            ctr = 0;
            while (ctr < xE.length) {
                if (tE[ctr] == 0) {
                    renderShadowBarrel(xE[ctr] - x + 512, yE[ctr] - y + 512, 26, 12, 0, dE[ctr]);
                    ctx.beginPath();
                    ctx.fillStyle = "rgb(110, 110, 110)";
                    ctx.arc((xE[ctr] - x) * 1.1 + 512, (yE[ctr] - y) * 1.1 + 512, 17, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.closePath();
                }
                if (tE[ctr] == 1) {
                    renderShadowBarrel(xE[ctr] - x + 512, yE[ctr] - y + 512, 34, 14, 0, dE[ctr]);
                    ctx.beginPath();
                    ctx.fillStyle = "rgb(110, 110, 110)";
                    ctx.arc((xE[ctr] - x) * 1.1 + 512, (yE[ctr] - y) * 1.1 + 512, 20, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.closePath();
                }
                if (tE[ctr] == 2) {
                    renderShadowBarrel(xE[ctr] - x + Math.cos(dE[ctr]) * 9 + 512, yE[ctr] - y + Math.sin(dE[ctr]) * 9 + 512, 34, 14, 0, dE[ctr]);
                    renderShadowBarrel(xE[ctr] - x - Math.cos(dE[ctr]) * 9 + 512, yE[ctr] - y - Math.sin(dE[ctr]) * 9 + 512, 34, 14, 0, dE[ctr]);
                    ctx.beginPath();
                    ctx.fillStyle = "rgb(110, 110, 110)";
                    ctx.arc((xE[ctr] - x) * 1.1 + 512, (yE[ctr] - y) * 1.1 + 512, 20, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.closePath();
                }
                ctr++;
            }
            ctr = 0;
            while (ctr < xS.length) {
                if (tS[ctr] == 0) {
                    ctr2 = 0;
                    cED = 200;
                    while (ctr2 < xE.length) {
                        if (Math.sqrt(Math.pow(xS[ctr] - xE[ctr2], 2) + Math.pow(yS[ctr] - yE[ctr2], 2)) < cED && Math.sqrt(Math.pow(xS[ctr] - xE[ctr2], 2) + Math.pow(yS[ctr] - yE[ctr2], 2)) < 200) {
                            cEV = ctr2;
                            dS[ctr] = Math.atan2(yE[cEV] - yS[ctr], xE[cEV] - xS[ctr]);
                            cED = Math.sqrt(Math.pow(xS[ctr] - xE[ctr2], 2) + Math.pow(yS[ctr] - yE[ctr2], 2));
                        }
                        ctr2++
                    }
                    if (tMRS[ctr] > 60 && cED < 200) {
                        tMRS[ctr] = 0;
                        summonBullet(xS[ctr], yS[ctr], dS[ctr], 30, 0, 15);
                    }
                    polygon(xS[ctr] - x + 512, yS[ctr] - y + 512, 6, 27, 0, "#555555");
                    renderBarrel(xS[ctr] - x + 512, yS[ctr] - y + 512, 43, 21, 0, dS[ctr]);
                    ctx.beginPath();
                    ctx.fillStyle = "#555555";
                    ctx.arc(xS[ctr] - x + 512, yS[ctr] - y + 512, 22, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.fillStyle = "#00B2E1";
                    ctx.arc(xS[ctr] - x + 512, yS[ctr] - y + 512, 19, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.strokeStyle = "rgba(85, 85, 85, " + ((0.35 / mHPS[ctr]) * (mHPS[ctr] - hPS[ctr]) + 0.05) + ")";
                    ctx.lineWidth = 11
                    ctx.arc(xS[ctr] - x + 512, yS[ctr] - y + 512, 55, 0, Math.PI * 2)
                    ctx.stroke();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.lineWidth = 5
                    ctx.strokeStyle = "rgba(106, " + Math.round((182 / mHPS[ctr]) * hPS[ctr]) + ", " + Math.round((100 / mHPS[ctr]) * hPS[ctr]) + ", " + ((0.875 / mHPS[ctr]) * (mHPS[ctr] - hPS[ctr]) + 0.125) + ")";
                    ctx.arc(xS[ctr] - x + 512, yS[ctr] - y + 512, 55, 0, ((Math.PI * 2) / mHPS[ctr]) * hPS[ctr]);
                    ctx.stroke();
                    ctx.closePath();
                }
                if (tS[ctr] == 1) {
                    ctr2 = 0;
                    cED = 350;
                    while (ctr2 < xE.length) {
                        if (Math.sqrt(Math.pow(xS[ctr] - xE[ctr2], 2) + Math.pow(yS[ctr] - yE[ctr2], 2)) < cED && Math.sqrt(Math.pow(xS[ctr] - xE[ctr2], 2) + Math.pow(yS[ctr] - yE[ctr2], 2)) < 350) {
                            cEV = ctr2;
                            dS[ctr] = Math.atan2(yE[cEV] - yS[ctr], xE[cEV] - xS[ctr]);
                            cED = Math.sqrt(Math.pow(xS[ctr] - xE[ctr2], 2) + Math.pow(yS[ctr] - yE[ctr2], 2));
                        }
                        ctr2++
                    }
                    if (tMRS[ctr] > 100 && cED < 350) {
                        tMRS[ctr] = 0;
                        summonBullet(xS[ctr], yS[ctr], dS[ctr], 30, 0, 15);
                    }
                    polygon(xS[ctr] - x + 512, yS[ctr] - y + 512, 6, 32, 0, "#555555");
                    renderBarrel(xS[ctr] - x + 512, yS[ctr] - y + 512, 50, 21, 0, dS[ctr]);
                    ctx.beginPath();
                    ctx.fillStyle = "#555555";
                    ctx.arc(xS[ctr] - x + 512, yS[ctr] - y + 512, 25, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.fillStyle = "#00B2E1";
                    ctx.arc(xS[ctr] - x + 512, yS[ctr] - y + 512, 22, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.strokeStyle = "rgba(85, 85, 85, " + ((0.35 / mHPS[ctr]) * (mHPS[ctr] - hPS[ctr]) + 0.05) + ")";
                    ctx.lineWidth = 11
                    ctx.arc(xS[ctr] - x + 512, yS[ctr] - y + 512, 55, 0, Math.PI * 2)
                    ctx.stroke();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.lineWidth = 5
                    ctx.strokeStyle = "rgba(106, " + Math.round((182 / mHPS[ctr]) * hPS[ctr]) + ", " + Math.round((100 / mHPS[ctr]) * hPS[ctr]) + ", " + ((0.875 / mHPS[ctr]) * (mHPS[ctr] - hPS[ctr]) + 0.125) + ")";
                    ctx.arc(xS[ctr] - x + 512, yS[ctr] - y + 512, 55, 0, ((Math.PI * 2) / mHPS[ctr]) * hPS[ctr]);
                    ctx.stroke();
                    ctx.closePath();
                }
                if (tS[ctr] == 2) {
                    ctr2 = 0;
                    cED = 200;
                    while (ctr2 < xE.length) {
                        if (Math.sqrt(Math.pow(xS[ctr] - xE[ctr2], 2) + Math.pow(yS[ctr] - yE[ctr2], 2)) < cED && Math.sqrt(Math.pow(xS[ctr] - xE[ctr2], 2) + Math.pow(yS[ctr] - yE[ctr2], 2)) < 200) {
                            cEV = ctr2;
                            dS[ctr] = Math.atan2(yE[cEV] - yS[ctr], xE[cEV] - xS[ctr]);
                            cED = Math.sqrt(Math.pow(xS[ctr] - xE[ctr2], 2) + Math.pow(yS[ctr] - yE[ctr2], 2));
                        }
                        ctr2++
                    }
                    if (tMRS[ctr] == 27 && cED < 200) {
                        summonBullet(xS[ctr] + Math.cos(dS[ctr]) * 10, yS[ctr] + Math.sin(dS[ctr]) * 10, dS[ctr], 30, 0, 15);
                    }
                    if (tMRS[ctr] > 54 && cED < 200) {
                        tMRS[ctr] = 0;
                        summonBullet(xS[ctr] - Math.cos(dS[ctr]) * 10, yS[ctr] - Math.sin(dS[ctr]) * 10, dS[ctr], 30, 0, 15);
                    }
                    polygon(xS[ctr] - x + 512, yS[ctr] - y + 512, 6, 32, 0, "#555555");
                    renderBarrel(xS[ctr] - x + 512, yS[ctr] - y + 512, 45, 21, 12, dS[ctr]);
                    renderBarrel(xS[ctr] - x + 512, yS[ctr] - y + 512, 45, 21, -12, dS[ctr]);
                    ctx.beginPath();
                    ctx.fillStyle = "#555555";
                    ctx.arc(xS[ctr] - x + 512, yS[ctr] - y + 512, 25, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.fillStyle = "#00B2E1";
                    ctx.arc(xS[ctr] - x + 512, yS[ctr] - y + 512, 22, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.strokeStyle = "rgba(85, 85, 85, " + ((0.35 / mHPS[ctr]) * (mHPS[ctr] - hPS[ctr]) + 0.05) + ")";
                    ctx.lineWidth = 11
                    ctx.arc(xS[ctr] - x + 512, yS[ctr] - y + 512, 55, 0, Math.PI * 2)
                    ctx.stroke();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.lineWidth = 5
                    ctx.strokeStyle = "rgba(106, " + Math.round((182 / mHPS[ctr]) * hPS[ctr]) + ", " + Math.round((100 / mHPS[ctr]) * hPS[ctr]) + ", " + ((0.875 / mHPS[ctr]) * (mHPS[ctr] - hPS[ctr]) + 0.125) + ")";
                    ctx.arc(xS[ctr] - x + 512, yS[ctr] - y + 512, 55, 0, ((Math.PI * 2) / mHPS[ctr]) * hPS[ctr]);
                    ctx.stroke();
                    ctx.closePath();
                }
                if (tS[ctr] == 3) {
                    ctr2 = 0;
                    cED = 200;
                    while (ctr2 < xE.length) {
                        if (Math.sqrt(Math.pow(xS[ctr] - xE[ctr2], 2) + Math.pow(yS[ctr] - yE[ctr2], 2)) < cED && Math.sqrt(Math.pow(xS[ctr] - xE[ctr2], 2) + Math.pow(yS[ctr] - yE[ctr2], 2)) < 200) {
                            cEV = ctr2;
                            dS[ctr] = Math.atan2(yE[cEV] - yS[ctr], xE[cEV] - xS[ctr]);
                            cED = Math.sqrt(Math.pow(xS[ctr] - xE[ctr2], 2) + Math.pow(yS[ctr] - yE[ctr2], 2));
                        }
                        ctr2++
                    }
                    if (tMRS[ctr] == 16 && cED < 200) {
                        summonBullet(xS[ctr] + Math.cos(dS[ctr]) * 10, yS[ctr] + Math.sin(dS[ctr]) * 10, dS[ctr] + 0.25, 30, 0, 15);
                    }
                    if (tMRS[ctr] == 32 && cED < 200) {
                        summonBullet(xS[ctr] + Math.cos(dS[ctr]) * 10, yS[ctr] + Math.sin(dS[ctr]) * 10, dS[ctr], 30, 0, 15);
                    }
                    if (tMRS[ctr] == 48 && cED < 200) {
                        summonBullet(xS[ctr] + Math.cos(dS[ctr]) * 10, yS[ctr] + Math.sin(dS[ctr]) * 10, dS[ctr] - 0.25, 30, 0, 15);
                    }
                    if (tMRS[ctr] > 64 && cED < 200) {
                        tMRS[ctr] = 0;
                        summonBullet(xS[ctr] - Math.cos(dS[ctr]) * 10, yS[ctr] - Math.sin(dS[ctr]) * 10, dS[ctr], 30, 0, 15);
                    }
                    polygon(xS[ctr] - x + 512, yS[ctr] - y + 512, 6, 32, 0, "#555555");
                    renderTrapezoidBarrel(xS[ctr] - x + 512, yS[ctr] - y + 512, 45, 21, 0, dS[ctr], 38);
                    ctx.beginPath();
                    ctx.fillStyle = "#555555";
                    ctx.arc(xS[ctr] - x + 512, yS[ctr] - y + 512, 25, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.fillStyle = "#00B2E1";
                    ctx.arc(xS[ctr] - x + 512, yS[ctr] - y + 512, 22, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.strokeStyle = "rgba(85, 85, 85, " + ((0.35 / mHPS[ctr]) * (mHPS[ctr] - hPS[ctr]) + 0.05) + ")";
                    ctx.lineWidth = 11
                    ctx.arc(xS[ctr] - x + 512, yS[ctr] - y + 512, 55, 0, Math.PI * 2)
                    ctx.stroke();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.lineWidth = 5
                    ctx.strokeStyle = "rgba(106, " + Math.round((182 / mHPS[ctr]) * hPS[ctr]) + ", " + Math.round((100 / mHPS[ctr]) * hPS[ctr]) + ", " + ((0.875 / mHPS[ctr]) * (mHPS[ctr] - hPS[ctr]) + 0.125) + ")";
                    ctx.arc(xS[ctr] - x + 512, yS[ctr] - y + 512, 55, 0, ((Math.PI * 2) / mHPS[ctr]) * hPS[ctr]);
                    ctx.stroke();
                    ctx.closePath();
                }
                tMRS[ctr]++
                if (hPS[ctr] <= 0) {
                    xS.splice(ctr, 1);
                    yS.splice(ctr, 1);
                    dS.splice(ctr, 1);
                    hPS.splice(ctr, 1);
                    mHPS.splice(ctr, 1);
                    tMRS.splice(ctr, 1);
                    tS.splice(ctr, 1);
                }
                ctr++;
            }
            ctr = 0;
            while (ctr < xE.length) {
                if (tE[ctr] == 0) {
                    ctr2 = 0;
                    cED = 120;
                    cED2 = 99999;
                    while (ctr2 < xS.length) {
                        if (Math.sqrt(Math.pow(xE[ctr] - xS[ctr2], 2) + Math.pow(yE[ctr] - yS[ctr2], 2)) < cED2) {
                            cEV2 = ctr2;
                            cED2 = Math.sqrt(Math.pow(xE[ctr] - xS[ctr2], 2) + Math.pow(yE[ctr] - yS[ctr2], 2));
                            dE[ctr] = Math.atan2(yS[cEV2] - yE[ctr], xS[cEV2] - xE[ctr]);
                        }
                        if (Math.sqrt(Math.pow(xE[ctr] - xS[ctr2], 2) + Math.pow(yE[ctr] - yS[ctr2], 2)) < cED && Math.sqrt(Math.pow(xE[ctr] - xS[ctr2], 2) + Math.pow(yE[ctr] - yS[ctr2], 2)) < 120) {
                            cEV = ctr2;
                            cED = Math.sqrt(Math.pow(xE[ctr] - xS[ctr2], 2) + Math.pow(yE[ctr] - yS[ctr2], 2));
                        }
                        ctr2++
                    }
                    if (Math.sqrt(Math.pow(xE[ctr] - xS[cEV2], 2) + Math.pow(yE[ctr] - yS[cEV2], 2)) > 100) {
                        xE[ctr] = xE[ctr] + Math.cos(dE[ctr]);
                        yE[ctr] = yE[ctr] + Math.sin(dE[ctr]);
                    }
                    if (cED < 120) {
                        if (tMRE[ctr] > 90) {
                            tMRE[ctr] = 0;
                            summonBullet(xE[ctr], yE[ctr], dE[ctr], 50, 1, 5);
                        }
                    }
                    ctx.beginPath();
                    ctx.fillStyle = "rgba(116, 0, 0, 0.02)";
                    ctx.arc((xE[ctr] - x) + 512, (yE[ctr] - y) + 512, 120, 0, 2 * Math.PI)
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.lineWidth = 5;
                    ctx.strokeStyle = "rgba(116, 0, 0, 0.09)";
                    ctx.arc((xE[ctr] - x) + 512, (yE[ctr] - y) + 512, 117.5, 0, 2 * Math.PI)
                    ctx.stroke();
                    ctx.closePath();
                    renderBarrel(xE[ctr] - x + 512, yE[ctr] - y + 512, 26, 12, 0, dE[ctr]);
                    ctx.beginPath();
                    ctx.fillStyle = "#555555";
                    ctx.arc(xE[ctr] - x + 512, yE[ctr] - y + 512, 15, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.fillStyle = "#F14E54";
                    ctx.arc(xE[ctr] - x + 512, yE[ctr] - y + 512, 12, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.closePath()
                    ctx.beginPath();
                    ctx.strokeStyle = "rgba(85, 85, 85, " + ((0.35 / mHPE[ctr]) * (mHPE[ctr] - hPE[ctr]) + 0.05) + ")";
                    ctx.lineWidth = 11
                    ctx.arc(xE[ctr] - x + 512, yE[ctr] - y + 512, 40, 0, Math.PI * 2)
                    ctx.stroke();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.lineWidth = 5
                    ctx.strokeStyle = "rgba(106, " + Math.round((182 / mHPE[ctr]) * hPE[ctr]) + ", " + Math.round((100 / mHPE[ctr]) * hPE[ctr]) + ", " + ((0.875 / mHPE[ctr]) * (mHPE[ctr] - hPE[ctr]) + 0.125) + ")";
                    ctx.arc(xE[ctr] - x + 512, yE[ctr] - y + 512, 40, 0, ((Math.PI * 2) / mHPE[ctr]) * hPE[ctr]);
                    ctx.stroke();
                    ctx.closePath();
                }
                if (tE[ctr] == 1) {
                    ctr2 = 0;
                    cED = 200;
                    cED2 = 99999;
                    while (ctr2 < xS.length) {
                        if (Math.sqrt(Math.pow(xE[ctr] - xS[ctr2], 2) + Math.pow(yE[ctr] - yS[ctr2], 2)) < cED2) {
                            cEV2 = ctr2;
                            cED2 = Math.sqrt(Math.pow(xE[ctr] - xS[ctr2], 2) + Math.pow(yE[ctr] - yS[ctr2], 2));
                            dE[ctr] = Math.atan2(yS[cEV2] - yE[ctr], xS[cEV2] - xE[ctr]);
                        }
                        if (Math.sqrt(Math.pow(xE[ctr] - xS[ctr2], 2) + Math.pow(yE[ctr] - yS[ctr2], 2)) < cED && Math.sqrt(Math.pow(xE[ctr] - xS[ctr2], 2) + Math.pow(yE[ctr] - yS[ctr2], 2)) < 200) {
                            cEV = ctr2;
                            cED = Math.sqrt(Math.pow(xE[ctr] - xS[ctr2], 2) + Math.pow(yE[ctr] - yS[ctr2], 2));
                        }
                        ctr2++
                    }
                    if (Math.sqrt(Math.pow(xE[ctr] - xS[cEV2], 2) + Math.pow(yE[ctr] - yS[cEV2], 2)) > 180) {
                        xE[ctr] = xE[ctr] + Math.cos(dE[ctr]) / 1.4;
                        yE[ctr] = yE[ctr] + Math.sin(dE[ctr]) / 1.4;
                    }
                    if (cED < 200) {
                        if (tMRE[ctr] > 150) {
                            tMRE[ctr] = 0;
                            summonBullet(xE[ctr], yE[ctr], dE[ctr], 50, 1, 15);
                        }
                    }
                    ctx.beginPath();
                    ctx.fillStyle = "rgba(116, 0, 0, 0.02)";
                    ctx.arc((xE[ctr] - x) + 512, (yE[ctr] - y) + 512, 200, 0, 2 * Math.PI)
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.lineWidth = 5;
                    ctx.strokeStyle = "rgba(116, 0, 0, 0.09)";
                    ctx.arc((xE[ctr] - x) + 512, (yE[ctr] - y) + 512, 197.5, 0, 2 * Math.PI)
                    ctx.stroke();
                    ctx.closePath();
                    renderBarrel(xE[ctr] - x + 512, yE[ctr] - y + 512, 34, 14, 0, dE[ctr]);
                    ctx.beginPath();
                    ctx.fillStyle = "#555555";
                    ctx.arc(xE[ctr] - x + 512, yE[ctr] - y + 512, 17, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.fillStyle = "#F14E54";
                    ctx.arc(xE[ctr] - x + 512, yE[ctr] - y + 512, 14, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.closePath()
                    ctx.beginPath();
                    ctx.strokeStyle = "rgba(85, 85, 85, " + ((0.35 / mHPE[ctr]) * (mHPE[ctr] - hPE[ctr]) + 0.05) + ")";
                    ctx.lineWidth = 11
                    ctx.arc(xE[ctr] - x + 512, yE[ctr] - y + 512, 40, 0, Math.PI * 2)
                    ctx.stroke();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.lineWidth = 5
                    ctx.strokeStyle = "rgba(106, " + Math.round((182 / mHPE[ctr]) * hPE[ctr]) + ", " + Math.round((100 / mHPE[ctr]) * hPE[ctr]) + ", " + ((0.875 / mHPE[ctr]) * (mHPE[ctr] - hPE[ctr]) + 0.125) + ")";
                    ctx.arc(xE[ctr] - x + 512, yE[ctr] - y + 512, 40, 0, ((Math.PI * 2) / mHPE[ctr]) * hPE[ctr]);
                    ctx.stroke();
                    ctx.closePath();
                }
                if (tE[ctr] == 2) {
                    ctr2 = 0;
                    cED = 120;
                    cED2 = 99999;
                    while (ctr2 < xS.length) {
                        if (Math.sqrt(Math.pow(xE[ctr] - xS[ctr2], 2) + Math.pow(yE[ctr] - yS[ctr2], 2)) < cED2) {
                            cEV2 = ctr2;
                            cED2 = Math.sqrt(Math.pow(xE[ctr] - xS[ctr2], 2) + Math.pow(yE[ctr] - yS[ctr2], 2));
                            dE[ctr] = Math.atan2(yS[cEV2] - yE[ctr], xS[cEV2] - xE[ctr]);
                        }
                        if (Math.sqrt(Math.pow(xE[ctr] - xS[ctr2], 2) + Math.pow(yE[ctr] - yS[ctr2], 2)) < cED && Math.sqrt(Math.pow(xE[ctr] - xS[ctr2], 2) + Math.pow(yE[ctr] - yS[ctr2], 2)) < 120) {
                            cEV = ctr2;
                            cED = Math.sqrt(Math.pow(xE[ctr] - xS[ctr2], 2) + Math.pow(yE[ctr] - yS[ctr2], 2));
                        }
                        ctr2++
                    }
                    if (Math.sqrt(Math.pow(xE[ctr] - xS[cEV2], 2) + Math.pow(yE[ctr] - yS[cEV2], 2)) > 100) {
                        xE[ctr] = xE[ctr] + Math.cos(dE[ctr]) / 1.7;
                        yE[ctr] = yE[ctr] + Math.sin(dE[ctr]) / 1.7;
                    }
                    if (cED < 120) {
                        if (tMRE[ctr] == 40) {
                            summonBullet(xE[ctr] + Math.cos(dE[ctr]) * 8, yE[ctr] + Math.sin(dE[ctr]) * 8, dE[ctr], 50, 1, 5);
                        }
                        if (tMRE[ctr] > 80) {
                            tMRE[ctr] = 0;
                            summonBullet(xE[ctr] - Math.cos(dE[ctr]) * 8, yE[ctr] - Math.sin(dE[ctr]) * 8, dE[ctr], 50, 1, 5);
                        }
                    }
                    ctx.beginPath();
                    ctx.fillStyle = "rgba(116, 0, 0, 0.02)";
                    ctx.arc((xE[ctr] - x) + 512, (yE[ctr] - y) + 512, 120, 0, 2 * Math.PI)
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.lineWidth = 5;
                    ctx.strokeStyle = "rgba(116, 0, 0, 0.09)";
                    ctx.arc((xE[ctr] - x) + 512, (yE[ctr] - y) + 512, 117.5, 0, 2 * Math.PI)
                    ctx.stroke();
                    ctx.closePath();
                    renderBarrel(xE[ctr] - x + 512, yE[ctr] - y + 512, 30, 14, 8, dE[ctr]);
                    renderBarrel(xE[ctr] - x + 512, yE[ctr] - y + 512, 30, 14, -8, dE[ctr]);
                    ctx.beginPath();
                    ctx.fillStyle = "#555555";
                    ctx.arc(xE[ctr] - x + 512, yE[ctr] - y + 512, 17, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.fillStyle = "#F14E54";
                    ctx.arc(xE[ctr] - x + 512, yE[ctr] - y + 512, 14, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.closePath()
                    ctx.beginPath();
                    ctx.strokeStyle = "rgba(85, 85, 85, " + ((0.35 / mHPE[ctr]) * (mHPE[ctr] - hPE[ctr]) + 0.05) + ")";
                    ctx.lineWidth = 11
                    ctx.arc(xE[ctr] - x + 512, yE[ctr] - y + 512, 40, 0, Math.PI * 2)
                    ctx.stroke();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.lineWidth = 5
                    ctx.strokeStyle = "rgba(106, " + Math.round((182 / mHPE[ctr]) * hPE[ctr]) + ", " + Math.round((100 / mHPE[ctr]) * hPE[ctr]) + ", " + ((0.875 / mHPE[ctr]) * (mHPE[ctr] - hPE[ctr]) + 0.125) + ")";
                    ctx.arc(xE[ctr] - x + 512, yE[ctr] - y + 512, 40, 0, ((Math.PI * 2) / mHPE[ctr]) * hPE[ctr]);
                    ctx.stroke();
                    ctx.closePath();
                }
                if (tE[ctr] == 3) {
                    ctr2 = 0;
                    cED = 120;
                    cED2 = 99999;
                    cEV3 = -1;
                    ctr3 = 0;
                    ctr4 = 0;
                    ctr5 = 0;
                    while (ctr3 < xS.length) {
                        while (ctr4 < xS.length) {
                            if (Math.sqrt(Math.pow(xS[ctr3] - xS[ctr4], 2) + Math.pow(yS[ctr3] - yS[ctr4], 2)) < 239 && Math.sqrt(Math.pow(xE[ctr] - (xS[ctr3] + xS[ctr4]) / 2, 2) + Math.pow(yE[ctr] - (yS[ctr3] + yS[ctr4]) / 2, 2)) < cED2) {
                                if (ctr5 == 0 || ctr3 != ctr4) {
                                    cEV2 = ctr3;
                                    cEV3 = ctr4;
                                    cED2 = Math.sqrt(Math.pow(xE[ctr] - (xS[ctr3] + xS[ctr4]) / 2, 2) + Math.pow(yE[ctr] - (yS[ctr3] + yS[ctr4]) / 2, 2));
                                    if (ctr3 != ctr4) {
                                        ctr5++;
                                    }
                                }
                                
                            }
                            ctr4++;
                        }
                        ctr4 = 0;
                        ctr3++;
                    }
                    while (ctr2 < xS.length) {
                        if (Math.sqrt(Math.pow(xE[ctr] - xS[ctr2], 2) + Math.pow(yE[ctr] - yS[ctr2], 2)) < 99999999) {
                            cED2 = Math.sqrt(Math.pow(xE[ctr] - xS[ctr2], 2) + Math.pow(yE[ctr] - yS[ctr2], 2));
                            if (cEV3 == -6666666) {
                                //dE[ctr] = Math.atan2(xE[ctr] - xS[cEV2], (yE[ctr] - yS[cEV2]) * -1);
                            } else {
                                dE[ctr] = Math.atan2((yS[cEV2] + yS[cEV3]) / 2 - yE[ctr], (xS[cEV2] + xS[cEV3]) / 2 - xE[ctr]);
                            }
                        }
                        if (Math.sqrt(Math.pow(xE[ctr] - xS[ctr2], 2) + Math.pow(yE[ctr] - yS[ctr2], 2)) < cED && Math.sqrt(Math.pow(xE[ctr] - xS[ctr2], 2) + Math.pow(yE[ctr] - yS[ctr2], 2)) < 120) {
                            cEV = ctr2;
                            cED = Math.sqrt(Math.pow(xE[ctr] - xS[ctr2], 2) + Math.pow(yE[ctr] - yS[ctr2], 2));
                        }
                        ctr2++
                    }
                    //if (Math.sqrt(Math.pow(xE[ctr] - xS[cEV2], 2) + Math.pow(yE[ctr] - yS[cEV2], 2)) > 100) {
                    if (Math.sqrt(Math.pow(xE[ctr] - (xS[cEV2] + xS[cEV3]) / 2, 2) + Math.pow(yE[ctr] - (yS[cEV2] + yS[cEV3]) / 2, 2)) > 5) {
                        xE[ctr] = xE[ctr] + Math.cos(dE[ctr]) / 0.7;
                        yE[ctr] = yE[ctr] + Math.sin(dE[ctr]) / 0.7;
                    } else {
                        dE[ctr] = Math.atan2(yS[cEV2] - yE[ctr], xS[cEV2] - xE[ctr]);
                    }
                    if (xS.length == 0) {
                        dE[ctr] = 0;
                    }
                    //}
                    if (cED < 120) {
                        if (tMRE[ctr] > 90) {
                            tMRE[ctr] = 0;
                            summonBullet(xE[ctr], yE[ctr], dE[ctr] + Math.PI, 50, 1, 5);
                            summonBullet(xE[ctr], yE[ctr], dE[ctr], 50, 1, 5);
                        }
                    }
                    ctx.beginPath();
                    ctx.fillStyle = "rgba(116, 0, 0, 0.02)";
                    ctx.arc((xE[ctr] - x) + 512, (yE[ctr] - y) + 512, 120, 0, 2 * Math.PI)
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.lineWidth = 5;
                    ctx.strokeStyle = "rgba(116, 0, 0, 0.09)";
                    ctx.arc((xE[ctr] - x) + 512, (yE[ctr] - y) + 512, 117.5, 0, 2 * Math.PI)
                    ctx.stroke();
                    ctx.closePath();
                    renderBarrel(xE[ctr] - x + 512, yE[ctr] - y + 512, 30, 14, 0, dE[ctr]);
                    renderBarrel(xE[ctr] - x + 512, yE[ctr] - y + 512, 30, 14, 0, dE[ctr] + Math.PI);
                    ctx.beginPath();
                    ctx.fillStyle = "#555555";
                    ctx.arc(xE[ctr] - x + 512, yE[ctr] - y + 512, 17, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.fillStyle = "#F14E54";
                    ctx.arc(xE[ctr] - x + 512, yE[ctr] - y + 512, 14, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.closePath()
                    ctx.beginPath();
                    ctx.strokeStyle = "rgba(85, 85, 85, " + ((0.35 / mHPE[ctr]) * (mHPE[ctr] - hPE[ctr]) + 0.05) + ")";
                    ctx.lineWidth = 11
                    ctx.arc(xE[ctr] - x + 512, yE[ctr] - y + 512, 40, 0, Math.PI * 2)
                    ctx.stroke();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.lineWidth = 5
                    ctx.strokeStyle = "rgba(106, " + Math.round((182 / mHPE[ctr]) * hPE[ctr]) + ", " + Math.round((100 / mHPE[ctr]) * hPE[ctr]) + ", " + ((0.875 / mHPE[ctr]) * (mHPE[ctr] - hPE[ctr]) + 0.125) + ")";
                    ctx.arc(xE[ctr] - x + 512, yE[ctr] - y + 512, 40, 0, ((Math.PI * 2) / mHPE[ctr]) * hPE[ctr]);
                    ctx.stroke();
                    ctx.closePath();
                }
                tMRE[ctr]++
                if (hPE[ctr] <= 0) {
                    xE.splice(ctr, 1);
                    yE.splice(ctr, 1);
                    dE.splice(ctr, 1);
                    hPE.splice(ctr, 1);
                    mHPE.splice(ctr, 1);
                    tMRE.splice(ctr, 1);
                    tE.splice(ctr, 1);
                }
                ctr++;
            }
            ctr = 0;
            while (ctr < xS.length) {
                if (tS[ctr] == 0 || tS[ctr] == 2 || tS[ctr] == 3) {
                    ctx.beginPath();
                    ctx.fillStyle = "rgba(0, 60, 110, 0.02)";
                    ctx.arc((xS[ctr] - x) + 512, (yS[ctr] - y) + 512, 200, 0, 2 * Math.PI)
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.lineWidth = 5;
                    ctx.strokeStyle = "rgba(0, 60, 110, 0.09)";
                    ctx.arc((xS[ctr] - x) + 512, (yS[ctr] - y) + 512, 197.5, 0, 2 * Math.PI)
                    ctx.stroke();
                    ctx.closePath();
                }
                if (tS[ctr] == 1) {
                    ctx.beginPath();
                    ctx.fillStyle = "rgba(0, 60, 110, 0.02)";
                    ctx.arc((xS[ctr] - x) + 512, (yS[ctr] - y) + 512, 350, 0, 2 * Math.PI)
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.lineWidth = 5;
                    ctx.strokeStyle = "rgba(0, 60, 110, 0.09)";
                    ctx.arc((xS[ctr] - x) + 512, (yS[ctr] - y) + 512, 347.5, 0, 2 * Math.PI)
                    ctx.stroke();
                    ctx.closePath();
                }
                ctr++
            }
            ctx.fillStyle = "#555555";
            ctx.font = "24px Consolas";
            ctx.fillText("Drag mouse to move around.", 10, 24);
            ctx.fillText("Press [SPACE] to spawn a tower.", 10, 48);
            ctx.fillText("Press [B] to spawn a sniper tower.", 10, 72);
            ctx.fillText("Press [E] to spawn a twin tower.", 10, 96);
            ctx.fillText("Press [A] to spawn an enemy tank.", 10, 120);
            ctx.fillText("Press [D] to spawn an enemy sniper.", 10, 144);
            ctx.fillText("Press [C] to spawn an enemy twin tank.", 10, 168);
            ctx.fillText("Press [W] to spawn an enemy flank guard [WIP].", 10, 192);
            ctx.fillText("Press [S] to spawn a machine gun tower [WIP].", 10, 216);
            ctx.fillText("Click a tower, and press a number key to upgrade (only works with basic tank).", 10, 240);
            ctx.fillText("Made by adasba.", 10, 264);
            //ctx.fillRect(xE[0] - x + 512, yE[0] - y + 512, 15, 15)
            if (sT == 1) {
                ctx.beginPath();
                ctx.strokeStyle = "rgba(0, 60, 110, 0.4)";
                ctx.lineWidth = 10;
                ctx.arc(xS[sTV] - x + 512, yS[sTV] - y + 512, 40, 0, Math.PI * 2);
                ctx.stroke();
                ctx.closePath();
                if (tS[sTV] == 0 || tS[sTV] == 2 || tS[sTV] == 3) {
                    ctx.beginPath();
                    ctx.fillStyle = "rgba(0, 60, 110, 0.10)";
                    ctx.arc((xS[sTV] - x) + 512, (yS[sTV] - y) + 512, 200, 0, 2 * Math.PI)
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.lineWidth = 5;
                    ctx.strokeStyle = "rgba(0, 60, 110, 0.45)";
                    ctx.arc((xS[sTV] - x) + 512, (yS[sTV] - y) + 512, 197.5, 0, 2 * Math.PI)
                    ctx.stroke();
                    ctx.closePath();
                }
                if (tS[sTV] == 1) {
                    ctx.beginPath();
                    ctx.fillStyle = "rgba(0, 60, 110, 0.10)";
                    ctx.arc((xS[sTV] - x) + 512, (yS[sTV] - y) + 512, 350, 0, 2 * Math.PI)
                    ctx.fill();
                    ctx.closePath();
                    ctx.beginPath();
                    ctx.lineWidth = 5;
                    ctx.strokeStyle = "rgba(0, 60, 110, 0.45)";
                    ctx.arc((xS[sTV] - x) + 512, (yS[sTV] - y) + 512, 347.5, 0, 2 * Math.PI)
                    ctx.stroke();
                    ctx.closePath();
                }
                if (tS[sTV] == 0) {
                    if (keys2[49] == 1) {
                        mHPS[sTV] = mHPS[sTV] + 125;
                        hPS[sTV] = hPS[sTV] + 125;
                        tS[sTV] = 2;
                        keys2[49] = 2;
                    }
                    if (keys2[50] == 1) {
                        mHPS[sTV] = mHPS[sTV] + 100;
                        hPS[sTV] = hPS[sTV] + 100;
                        tS[sTV] = 3;
                        keys2[50] = 2;
                    }
                    if (keys2[51] == 1) {
                        mHPS[sTV] = mHPS[sTV] + 75;
                        hPS[sTV] = hPS[sTV] + 75;
                        tS[sTV] = 1;
                        keys2[51] = 2;
                    }
                }
            }
            ctx.beginPath();
            ctx.fillStyle = "#75C6C3";
            ctx.lineWidth = 7;
            ctx.fillRect(50, 820, 150, 85);
            ctx.fill();
            ctx.closePath();
            ctx.beginPath();
            ctx.fillStyle = "#60A2A0";
            ctx.lineWidth = 7;
            ctx.fillRect(50, 905, 150, 65);
            ctx.fill();
            ctx.closePath();
            ctx.beginPath();
            ctx.strokeStyle = "#555555";
            ctx.lineWidth = 7;
            ctx.strokeRect(50, 820, 150, 150);
            ctx.stroke();
            ctx.closePath();
            polygon(125, 895, 6, 40, 0, "#555555");
            renderBarrel(125, 895, 56.25, 26.25, 15, lctr / 100);
            renderBarrel(125, 895, 56.25, 26.25, -15, lctr / 100);
            ctx.beginPath();
            ctx.fillStyle = "#555555";
            ctx.arc(125, 895, 31.25, 0, Math.PI * 2);
            ctx.fill();
            ctx.closePath();
            ctx.beginPath();
            ctx.fillStyle = "#00B2E1";
            ctx.arc(125, 895, 28.25, 0, Math.PI * 2);
            ctx.fill();
            ctx.closePath();
            setTimeout(loop, 10);
            lctr++;
        }
        loop();
        //Changelog:
        //Update 0.1.1.1: Working on upgrade graphics, several graphical changes, and condensing code..
        //Update 0.1.1: Added the ability to upgrade tanks by clicking on them and pressing a number key....
        //Added blue machine gun.
        //Update 0.1: Started recording updates in a changelog.
    </script>
</body>
</html>